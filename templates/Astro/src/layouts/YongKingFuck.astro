---
interface Props {
  keywords?: string[]
}
import BaseModule from '@layouts/baseModule.astro'
const isIndex = Astro.url.pathname.endsWith('/index') || Astro.url.pathname === '/'
const isDev = import.meta.env.MODE === 'development'
const keywords = Astro.props.keywords || []
---

<BaseModule root="opsl" isIndex={isIndex} isDev={isDev} keywords={isIndex ? keywords : undefined}>
  <Fragment slot="demo">
    <!-- menu.css custom.css 放這裡 -->
  </Fragment>
  <Fragment slot="head">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&family=Noto+Serif+TC:wght@200..900&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet" />
  </Fragment>
  <slot />
</BaseModule>

<style lang="scss" is:global>
  @use 'sass:math';
  @use '@config/breakpoint' as bp;
  // reset module8
  .edit,
  .show_content,
  .main_part {
    width: 100% !important;
    max-width: 100% !important;
    margin: auto !important;
    padding: 0px !important;
  }
  .pageIndex .main_part {
    border: none !important;
  }
  .path,
  .banner {
    display: none;
  }
  .edit_part {
    max-width: 100%;
    margin: auto;
    padding: 0;
  }
  .animated15 {
    animation: none;
  }

  // 字體大小
  $font-size: 18;

  // 字體大小基礎占比
  @function base-ratio($value) {
    // 參數設置
    $min: 16;
    $max: 80;
    $upper: 0.8;
    $lower: 0.2;
    $power: 2;

    // 超過區間
    @if $value < $min {
      @return $upper;
    } @else if $value > $max {
      @return $lower;
    }

    @return $lower + ($upper - $lower) * (1 - math.pow(math.div(($value - $min), ($max - $min)), $power));
  }
  .opsl {
    --f_base: 1rem;
    // 先取一個基礎值(--f_base * 占比)，值越小基礎值占比越大，剩餘換算成vw補齊
    @each $size in $font-size {
      // 縮放區間
      $lg: bp.value(2xl);
      $sm: bp.value(sm);
      // 相對於--f_base的基礎值比例
      $fbase: math.div(math.round(math.div($size, 16) * base-ratio($size) * 100), 100);
      // vw補齊剩餘空間
      $fvw: math.div(math.round(math.div($size * (1 - base-ratio($size)), $lg) * 10000), 100);
      // 最小值
      $fmin: math.round($fbase * 16 + math.div($sm * $fvw, 100));

      --f#{$size}: clamp(#{$fmin}px, calc(var(--f_base) * #{$fbase} + #{$fvw}vw), #{$size}px);
    }
    --pd20: 1.25rem;
    --pd30: 1.875rem;
    --pd40: 2.5rem;
    --pd60: 3.75rem;
    --pd80: 5rem;
    --pd100: 6.25rem;
    --pd150: 9.375rem;
    --pd200: 12.5rem;
    --pd250: 15.625rem;
    --pd300: 18.75rem;
    --pd400: 25rem;

    font-size: var(--f18);
    font-family: 'Microsoft JhengHei', serif;
    overflow: hidden;
    line-height: 1.8;
    letter-spacing: 0;
  }

  @media (max-width: 1024px) {
    .opsl {
      --pd20: 1.25rem;
      --pd30: 1.875rem;
      --pd40: 2.5rem;
      --pd60: 3.75rem;
      --pd80: 4.375rem;
      --pd100: 5rem;
      --pd150: 7.5rem;
      --pd200: 10rem;
      --pd250: 12.5rem;
      --pd300: 15rem;
      --pd400: 18.75rem;
    }
  }
  @media (max-width: 768px) {
    .opsl {
      --pd20: 0.94rem;
      --pd30: 1.25rem;
      --pd40: 1.875rem;
      --pd60: 3.125rem;
      --pd80: 3.75rem;
      --pd100: 3.75rem;
      --pd150: 6.25rem;
      --pd200: 6.25rem;
      --pd250: 9.375rem;
      --pd300: 9.375rem;
      --pd400: 12.5rem;
    }
  }

  [data-animate-in] {
    opacity: 0;
    transition:
      transform 0.8s ease,
      opacity 0.8s ease;
  }
  [data-animate-in='up'] {
    transform: translate3d(0, 10%, 0);
  }
  [data-animate-in='left'] {
    transform: translate3d(-5%, 0, 0);
  }
  [data-animate-in='right'] {
    transform: translate3d(5%, 0, 0);
  }
  [data-animate-in='down'] {
    transform: translate3d(0, -10%, 0);
  }
  [data-animate-in='fadeIn'] {
    transform: translate3d(0, 0, 0);
  }
  [data-animate-in='scaleIn'] {
    transform: scale(0.3);
  }
  [data-animate-in='rotateIn'] {
    transform: scale(0.3) rotate(-10deg);
  }
  [data-animate-in].in-view {
    opacity: 1;
    transform: translate3d(0, 0, 0) rotate(0deg);
  }
</style>
